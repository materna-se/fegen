<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Frontend - FeGen</title>
        
        


        <!-- Custom HTML head -->
        


        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        
        <link rel="icon" href="../favicon.svg">
        
        
        <link rel="shortcut icon" href="../favicon.png">
        
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        
        <link rel="stylesheet" href="../css/print.css" media="print">
        

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        
        <link rel="stylesheet" href="../fonts/fonts.css">
        

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        

        
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="../intro.html">Introduction</a></li><li class="chapter-item expanded "><a href="../quickstart/intro.html"><strong aria-hidden="true">1.</strong> Quick Start Guide</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../quickstart/setup.html"><strong aria-hidden="true">1.1.</strong> Setup</a></li><li class="chapter-item expanded "><a href="../quickstart/backend.html"><strong aria-hidden="true">1.2.</strong> Backend</a></li><li class="chapter-item expanded "><a href="../quickstart/frontend.html" class="active"><strong aria-hidden="true">1.3.</strong> Frontend</a></li><li class="chapter-item expanded "><a href="../quickstart/further_reading.html"><strong aria-hidden="true">1.4.</strong> Further Reading</a></li></ol></li><li class="chapter-item expanded "><a href="../reference/intro.html"><strong aria-hidden="true">2.</strong> Reference Documentation</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../reference/plugin_configuration/intro.html"><strong aria-hidden="true">2.1.</strong> Plugin Configuration</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../reference/plugin_configuration/gradle.html"><strong aria-hidden="true">2.1.1.</strong> Gradle</a></li><li class="chapter-item expanded "><a href="../reference/plugin_configuration/maven.html"><strong aria-hidden="true">2.1.2.</strong> Maven</a></li><li class="chapter-item expanded "><a href="../reference/plugin_configuration/configuration_options.html"><strong aria-hidden="true">2.1.3.</strong> Configuration Options</a></li><li class="chapter-item expanded "><a href="../reference/plugin_configuration/backend.html"><strong aria-hidden="true">2.1.4.</strong> Backend Configuration</a></li></ol></li><li class="chapter-item expanded "><a href="../reference/data_model/intro.html"><strong aria-hidden="true">2.2.</strong> Data Model</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../reference/data_model/entities.html"><strong aria-hidden="true">2.2.1.</strong> Entities</a></li><li class="chapter-item expanded "><a href="../reference/data_model/relationships.html"><strong aria-hidden="true">2.2.2.</strong> Relationships</a></li><li class="chapter-item expanded "><a href="../reference/data_model/custom_endpoints.html"><strong aria-hidden="true">2.2.3.</strong> Custom Endpoints</a></li><li class="chapter-item expanded "><a href="../reference/data_model/embeddables.html"><strong aria-hidden="true">2.2.4.</strong> Embeddables</a></li><li class="chapter-item expanded "><a href="../reference/data_model/fegen_ignore.html"><strong aria-hidden="true">2.2.5.</strong> @FegenIgnore</a></li></ol></li><li class="chapter-item expanded "><a href="../reference/retrieving/intro.html"><strong aria-hidden="true">2.3.</strong> Retrieving Data</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../reference/retrieving/paging_sorting.html"><strong aria-hidden="true">2.3.1.</strong> Paging and Sorting</a></li><li class="chapter-item expanded "><a href="../reference/retrieving/projections.html"><strong aria-hidden="true">2.3.2.</strong> Projections</a></li><li class="chapter-item expanded "><a href="../reference/retrieving/repository_searches.html"><strong aria-hidden="true">2.3.3.</strong> Repository Searches</a></li><li class="chapter-item expanded "><a href="../reference/retrieving/custom_searches.html"><strong aria-hidden="true">2.3.4.</strong> Custom Searches</a></li></ol></li><li class="chapter-item expanded "><a href="../reference/targets/intro.html"><strong aria-hidden="true">2.4.</strong> Targets</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../reference/targets/typescript.html"><strong aria-hidden="true">2.4.1.</strong> Typescript</a></li><li class="chapter-item expanded "><a href="../reference/targets/kotlin.html"><strong aria-hidden="true">2.4.2.</strong> Kotlin</a></li></ol></li><li class="chapter-item expanded "><a href="../reference/security.html"><strong aria-hidden="true">2.5.</strong> Security</a></li><li class="chapter-item expanded "><a href="../reference/pitfalls.html"><strong aria-hidden="true">2.6.</strong> Pitfalls</a></li></ol></li><li class="chapter-item expanded "><a href="../developing/intro.html"><strong aria-hidden="true">3.</strong> Developing FeGen</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../developing/building.html"><strong aria-hidden="true">3.1.</strong> Building</a></li><li class="chapter-item expanded "><a href="../developing/architecture.html"><strong aria-hidden="true">3.2.</strong> Architecture</a></li><li class="chapter-item expanded "><a href="../developing/local_usage.html"><strong aria-hidden="true">3.3.</strong> Using a Custom Build Locally</a></li><li class="chapter-item expanded "><a href="../developing/contributing.html"><strong aria-hidden="true">3.4.</strong> Contributing</a></li><li class="chapter-item expanded "><a href="../developing/publishing.html"><strong aria-hidden="true">3.5.</strong> Publishing</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                        
                    </div>

                    <h1 class="menu-title">FeGen</h1>

                    <div class="right-buttons">
                        
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        
                        
                    </div>
                </div>

                
                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" name="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="creating-the-frontend"><a class="header" href="#creating-the-frontend">Creating the Frontend</a></h1>
<p>On this page you will create the website that will display the actual todo list and access the backend using FeGen to store the todo list items.</p>
<h2 id="instantiate-the-api-client"><a class="header" href="#instantiate-the-api-client">Instantiate the API client</a></h2>
<p>If you have not yet done it after the last step, run <code>./gradlew fegenWeb</code> in the <code>backend</code> directory.
You should see generated files in the <code>frontend/src/api-client</code> directory.</p>
<p>The code generated by FeGen does not know under which URL the backend can be found, so you will need to pass that information when instantiating the api client.</p>
<p>Replace the content of <code>frontend/src/main.ts</code> with the following:</p>
<pre><code class="language-typescript">import {ApiClient} from &quot;./api-client/ApiClient&quot;;

const apiClient = new ApiClient(new FetchAdapter(&quot;http://localhost:8080&quot;));
</code></pre>
<p>The second line creates a new instance of <code>ApiClient</code>, which is generated by FeGen and takes an instance of <code>FetchAdapter</code> which controls how HTTP communication is done by the generated code.
It takes the base URL (the URL where the client expects find the backend) as first parameter.
Since you will run the backend on the same machine for now and Spring applications by default run on port <code>8080</code> and do not offer HTTPS, the base URL is <code>http://localhost:8080</code> in this case.</p>
<blockquote>
<p>In a production environment, you will need to change that base url.
Depending on your use case, you may want to use the same web server to deliver your frontend and handle your backend api calls.
In that case, it is a good idea to set a base path in Spring that the paths of all your API URLs start with.
If you use some kind of reverse proxy, you will also need to configure Spring to correctly recognize under what domain it is running.
To learn how to do this, refer to the <a href="../reference/plugin_configuration/backend.html">Backend Configuration</a> page of the reference documentation.</p>
</blockquote>
<h2 id="displaying-the-empty-list-of-todos"><a class="header" href="#displaying-the-empty-list-of-todos">Displaying the (empty) List of Todos</a></h2>
<p>To show the todo items when opening the web app, append the following code to your <code>frontend/src/main.ts</code>:</p>
<pre><code class="language-typescript">/**
 * Create an HTML element representing the given todoItem
 */
const createTodoElement = (todoItem: TodoItem): HTMLElement =&gt; {
    const todoEl = document.createElement(&quot;div&quot;);

    const doneEl = document.createElement(&quot;input&quot;);
    doneEl.type = &quot;checkbox&quot;;
    doneEl.checked = todoItem.done;
    todoEl.appendChild(doneEl);

    const textEl = document.createElement(&quot;span&quot;);
    textEl.textContent = todoItem.text;
    todoEl.appendChild(textEl);
    
    return todoEl;
}

const loadTodoItems = () =&gt; {
    // Get the &lt;div&gt; element that will contain the items
    const listEl = document.querySelector(&quot;#todoItems&quot;)!;
    // Remove old items if there have been any
    listEl.innerHTML = &quot;&quot;;
    apiClient.todoItemClient.readAll().then(todoItems =&gt; {
        for (const todoItem of todoItems.items) {
            const itemEl = createTodoElement(todoItem);
            listEl.appendChild(itemEl);
        }
    }).catch(err =&gt; {
        console.error(&quot;Failed to fetch todo items&quot;, err);
        alert(&quot;Failed to fetch todo items&quot;)
    });
};
</code></pre>
<p>The line starting with <code>apiClient</code> refers to the variable you created in the previous step.
It contains an instance of a class generated by FeGen.
That class has a member called <code>todoItemClient</code> that contains method for basic CRUD functionality for the TodoItem entity like reading all instances of that entity.
FeGen will create such a member for each Entity / Repository combination you define.</p>
<p>The <code>readAll</code> method returns all todo item entity that currently exist in the backend.
It does not return them as a plain array though, but as a <code>Promise</code>, so the execution of frontend code is not interrupted while the browser is waiting for the backend to respond.
Using the <code>then</code> method of that <code>Promise</code>, we can specify what to do with the todo items once they are successfully retrieved from the backend.
The <code>todoItems</code> parameter is correctly typed using a type generated by FeGen, so you can enjoy autocompletion while iterating through the contained <code>items</code> array and accessing the <code>text</code> property that you have defined for that entity in the backend.
In case something goes wrong while retrieving the todo items (for example, if the backend server cannot be reached) the callback passed to the <code>catch</code> block is called, and you will see a dialog box.</p>
<blockquote>
<p>The method <code>readAll</code> actually does not return all elements by default, but only up to 20.
To learn how to configure this behaviour, refer to the <a href="../reference/retrieving/paging_sorting.html">Paging and Sorting</a> page of the reference documentation</p>
</blockquote>
<blockquote>
<p>There are various ways besides a simple call to <code>readAll</code> to retrieve entities from the backend.
For example, you can pass sorting and paging parameters to <code>readAll</code> to only retrieve a sublist of a certain length in a specific order.
You can also create projections in the backend which specify a set of fields to return, which enables you to query related entities in one step.
With repository and custom searches you are able to filter the entities that are returned by the backend.
To learn how you can use these options with FeGen, refer to the <a href="../reference/retrieving/intro.html">Retrieving Data</a> page of the reference documentation</p>
</blockquote>
<p>To actually run the code, you need to call the function that contains it, so append the following line at the bottom of <code>main.ts</code>:</p>
<pre><code class="language-typescript">const onReady = () =&gt; {
    loadTodoItems();
};

if (document.readyState !== 'loading') {
    // HTML is already completely initialized
    onReady();
} else {
    // Wait until initialization has completed
    document.addEventListener('DOMContentLoaded', onReady);
}
</code></pre>
<p>You can start the web app by running <code>./gradlew bootRun</code> in the <code>backend</code> directory and at the same time running <code>npm run dev</code> in the <code>frontend</code> directory.
However, if you open <code>http://localhost:5000/</code> in your browser, you will only see the headline, because there aren't any todo items yet.</p>
<h2 id="adding-todo-items"><a class="header" href="#adding-todo-items">Adding Todo Items</a></h2>
<p>To add todo items, we first need an input field to enter the new item's text and a button to trigger the creation.
Add the following HTML just below the <code>&lt;h1&gt;Todo App&lt;/h1&gt;</code> tag:</p>
<pre><code class="language-html">&lt;div&gt;
  &lt;label&gt;
    New Todo:
    &lt;input id=&quot;newTodoText&quot; type=&quot;text&quot; /&gt;
  &lt;/label&gt;
  &lt;button id=&quot;newTodoButton&quot;&gt;Create&lt;/button&gt;
&lt;/div&gt;
</code></pre>
<p>Now we still need to give that button some functionality.
Add the following code between the <code>loadTodoItems</code> and the <code>onReady</code> function:</p>
<pre><code class="language-typescript">const createTodo = async () =&gt; {
    const text = document.querySelector&lt;HTMLInputElement&gt;(&quot;#newTodoText&quot;).value;
    await apiClient.todoItemClient.create({
        text,
        done: false
    });
    // Use async function and await create result to avoid loading items before creation has finished
    loadTodoItems();
};
</code></pre>
<p>This will read the text out of the input element and use the code generated by FeGen to create a new instance of the todo item entity with that text in the backend.
After it waits for that operation to complete, it loads the todo items from the server again and updates the list.</p>
<blockquote>
<p>If you are developing a real application, you should probably wrap the call to <code>create</code> together with the <code>await</code> in a try block and let the user know if an error occurred in the corresponding <code>catch</code> block.
That is the async function equivalent to the error handling you did with <code>catch</code> when fetching all todo items.</p>
</blockquote>
<p>To run this code whenever the <code>Create</code> button is clicked, add the following line at the end of the <code>onReady</code> function body:</p>
<pre><code class="language-typescript">document.querySelector&lt;HTMLButtonElement&gt;(&quot;#newTodoButton&quot;).onclick = createTodo;
</code></pre>
<p>If you left <code>./gradlew bootRun</code> and <code>npm run dev</code> running, you will now be able to add todo items by entering a text and pressing <code>Create</code> after reloading the page once.
The todo items' texts should then appear below.
Try to reload the page or close and open the browser, and you will see that the todo items appear again because they are persisted in the backend.</p>
<blockquote>
<p>If you stop and restart the backend, the todo items will be lost, since you are currently only using the h2 in-memory database.
For applications used in a production environment, you should use a persistent database such as PostgreSQL.</p>
</blockquote>
<h2 id="modifying-todo-items"><a class="header" href="#modifying-todo-items">Modifying Todo Items</a></h2>
<p>You can already click the checkbox in front of each todo item to mark it as done, but that change will not be saved if you reload the application.
To make the changes persistent, add the following code between the lines <code>doneEl.checked = todoItem.done;</code> and <code>todoEl.appendChild(doneEl);</code> within the <code>createTodoElement</code> function's body:</p>
<pre><code class="language-typescript">doneEl.onchange = async () =&gt; {
  await apiClient.todoItemClient.update({
    ...todoItem,
    done: doneEl.checked
  });
  loadTodoItems();
};
</code></pre>
<p>Now each time the checkbox is clicked, the frontend will propagate the change to the backend, so you can reload the web app and still see which todos are done.</p>
<blockquote>
<p>Keep in mind that the <code>todoItem</code> variable does not only contain the <code>text</code> and <code>done</code> fields, but also the <code>id</code> field which is necessary for Spring to find the correct entity to modify.
This is why just replacing <code>...todoItem</code> by <code>text: todoItem.text</code> won't work.</p>
</blockquote>
<h2 id="deleting-todo-items"><a class="header" href="#deleting-todo-items">Deleting Todo Items</a></h2>
<p>Now that we can create todo items and mark them as done, there should also be a way to get rid of them.
Add the following code just above the <code>return todoEl</code> within the <code>createTodoElement</code> function's body:</p>
<pre><code class="language-typescript">const deleteButtonEl = document.createElement(&quot;button&quot;);
deleteButtonEl.textContent = &quot;X&quot;;
deleteButtonEl.onclick = async () =&gt; {
    await apiClient.todoItemClient.delete(todoItem);
    loadTodoItems();
};
todoEl.appendChild(deleteButtonEl);
</code></pre>
<p>The items in the list will now not only consist of a text, but also a button to delete the todo item.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        
                            <a rel="prev" href="../quickstart/backend.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                        

                        
                            <a rel="next" href="../quickstart/further_reading.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                
                    <a rel="prev" href="../quickstart/backend.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                

                
                    <a rel="next" href="../quickstart/further_reading.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
                
            </nav>

        </div>

        

        

        

        
        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        

        

        
        <script src="../elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../searcher.js" type="text/javascript" charset="utf-8"></script>
        

        <script src="../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="../book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        

        

    </body>
</html>
